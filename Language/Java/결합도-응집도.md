> *결합도는 낮추고, 응집도는 높여야 유지보수하기 쉽다.*
> 

## 모듈(Module)

- 크기와 상관없이 클래스나 패키지, 라이브러리와 같이 프로그램을 구성하는 임의의 요소
- 모든 모듈은 제대로 실행되어야 하고, 변경이 용이해야 하며, 이해하기 쉬워야한다.

## 결합도(Coupling)

![Untitled](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FzA6KG%2Fbtrp8qtcaVw%2Fr08zKzEuZcQJNm6pRiXQF0%2Fimg.png)

- 결합도는 다른 모듈간의 의존도를 의미한다.
- **모듈 수정을 위해 다른 모듈의 변경을 요구하는 정도**
- 모듈이 다른 모듈에 의존하는 정도의 척도
- 모듈과 모듈간의 상호 결합 정도
- 보통 프로그램은 하나의 모듈이 아닌 위 그림처럼 **여러개의 모듈**로 이루어져 있다.
    - 즉, **결합도는 각각 모듈간에 영향을 주는 의존도**를 의미한다.
- b라는 기능을 수정하기 위해 b 기능이 모여있는 B모듈을 수정할 때, 다른 모듈들과 연관되어 수정하려면 다른 모듈의 소스도 확인하면서 해야한다.
    - 필요 시 다른 모듈들까지 수정해야 한다면 유지보수가 매우 어렵다 → 결합도가 높다!
    - 반대로 A 모듈이 다른 모듈들을 참조하는 부분이 거의 없어 의존도가 낮은 상황이라면 유지보수하기 편하다 → 느슨하게 연결되었다 (결합도가 낮다)
- 결합도가 높으면 변경하고 검토해야하는 모듈 수가 많아지는 단점이 있으니, **결합도가 낮을수록 검토해야하는 소스의 수가 적어져서 코드를 수정하기 쉬워진다.**

## 응집도(Cohesion)

![Untitled](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FbZd7mx%2FbtrqgbaHaRV%2FZK5uzpWmhcDmykHG0t6qz1%2Fimg.png)

- 응집도는 **하나의 모듈 내부의 기능 집중도**를 의미한다.
- 모듈에 포함된 내부 요소들이 **‘하나의’ 책임, 목적을 위해 연결**되어 있는 연관된 정보이다.
- 모듈이 **하나의 목적을 수행하는 요소들간의 연관성 척도**
- 모듈 내부의 기능적인 응집 정도를 나타낸다.
- 하나의 모듈에는 그 모듈이 정상적으로 수행되기 위한 여러 기능들이 있는데, 그 기능들이 모듈의 목적을 달성하도록 연관있게 연결되어 있어야 한다.
- 만약 A 모듈이 아닌 곳에 a 기능이 흩어져 있거나, A모듈에 a 기능 외에 다른 기능들도 복잡하게 섞여서 구현되어 있다면 수정하기 어렵다.
    - 반면에, A 모듈 안에 a라는 기능을 위해 모여있고 긴밀하게 연결되어 협력하고 있다면 그 모듈은 높은 응집도를 가진다고 볼 수 있다.
- 응집도가 높으면, 변경 대상과 범위가 명확해지기 때문에 코드를 수정하기 쉽다.

## 결합도가 높은 클래스

- 결합도가 높은 클래스의 경우 **연관된 클래스가 변경되면 해당 클래스는 수정이 필요**하게 된다.
- 프로그램이 작을 땐 문제가 되지 않지만, 만약 큰 프로그램이라면 굉장히 복잡하고 번거로워진다.
- 수정을 위해서는 연관된 클래스를 모두 이해하고 있어야 하는데, 프로그램이 커지면 커질수록 더욱 어려운 일이 된다.

### 결합도는 높으면 무조건 문제가 되는가?

- 변경될 가능성이 적은 모듈의 경우 결합도가 높아도 문제가 되지 않는다.
    - 표준 라이브러리의 포함된 모듈이나 성숙 단계에 접어든 모듈에 의존하는 경우
- 하지만, 우리가 작성하고 설계한 코드는 갑작스러운 요구사항에 변경되기 쉽다.
    - 따라서 모듈간 변화의 영향을 줄이고 의존성을 낮추고 재사용성을 높일 수 있도록 결합도가 낮게 유지되도록 노력해야 한다.
- 추가적으로 인터페이스에 의존하는 코드 작성은 낮은 결합도를 얻을 수 있다.

## 응집도가 낮은 클래스

- 응집도가 낮다는 말은 **한 클래스에 여러 기능**이 있다는 의미
- 이는 **코드를 읽는 사람이 해당 클래스를 쉽게 이해하지 못한다는 의미**이다.
- 또한, 이러한 클래스는 보통 재사용하기 어려운 코드일 가능성이 높다.

### 응집도가 높으면 무조건 좋은가?

- 응집도가 높으면 수정해야 할 코드가 한군데 모여있기 때문에 수정되는 부분을 파악하기 쉽다. → 유지보수하기 좋다.
- 서로 다른 코드를 하나의 모듈에 뭉쳐놓고, 그 중 하나의 코드에 변경해야되는 상황이 발생한 경우 함께 존재한다는 이유만으로도 모듈 내 변경될 필요가 없는 코드도 수정해야할 이슈가 발생할 수 있다.
- 하나의 모듈에 수정해야할 코드가 모여있지 않고 엉뚱한 곳에도 코드가 모여있는 경우 한 곳에 모여있을 때 보다 복잡해져서 코드 수정이 더 어려워진다.

→ 따라서 응집도가 높으면 복잡도를 낮출 수 있다.

## 낮은 결합도 예시

```java
public interface StockExchange {
    Money currentPrice(String symbol);
}

public class Portfolio {
    private StockExchange exchange;
    
    public Portfolio(StockExchange exchange) {
    	this.exchange = exchange
    }
    
    // ...
}
```

- Portfolio 클래스는 한국, 미국, 일본 등 외부 API(StockExchange)를 활용하여 포트폴리오 값을 계산해야 한다.
- 하지만 위 예제는 StockExchange라는 인터페이스를 이용해 어떤 외부 API든 다 구현이 가능하도록 설계했다.
- 위 코드는 SOLID 원칙 중 DIP 원칙을 지켜 추상화를 이용하여 설계한 사례이다.
    - DIP는 클래스가 상세한 구현ㄴ이 아니라 추상화에 의존하도록 구현하는 원칙이다.
- 시스템의 결합도를 낮추면 유연성과 재사용성이 높아진다.

## 높은 응집도 예시

```java
public class Stack {
    private int topOfStack = 0;
    private List<Integer> elements = new LinkedList<Integer>();
    
    public int size() {
    	return topOfStack;
    }
    
    public void push(int element) {
    	topOfStack++;
        elements.add(element);
    }
    
    public int pop() throws PoppedWhenEmpty {
    	if (topOfStack == 0) {
        	throw new PoppedWhenEmpty();
        }
        int element = elements.get(--topOfStack);
        elements.remove(topOfStack);
        return element;
    }
}
```

- Stack을 구현한 코드이다.
- 보통 **메서드가 인스턴스 변수를 많이 사용하면 사용할수록 메서드와 클래스는 응집도가 높아지는데**, 위 코드는 각 메서드마다 인스턴스 변수를 사용해줌으로써 응집도를 높였다.
    - 보통 **클래스의 메서드는 인스턴스 변수를 하나 이상 사용**해야 한다.
- 응집도가 높다는 것은 **클래스에 속한 메서드와 변수가 서로 의존하며 논리적인 단위로 묶인다는 것**이다.
    - 즉, 서로 관계있는 것들로만 모인다는 것이다.
- 종종 설계를 하다보면 인스턴스 변수가 많아지는 경우를 볼 수 있다.
    - **몇몇 메서드가 몇몇개의 인스턴스 변수만 사용한다면 클래스가 응집력을 잃어가고 있다는 의미** → 클래스를 쪼개줘야 한다.
    - 큰 메서드를 작은 메서드 여러개로 쪼개다보면 종종 작은 클래스 여러개로 쪼갤 수 있게 되는데, 점차 프로그램의 체계도 잡히고 구조도 투명해진다.

## 참고 자료

- [https://devkingdom.tistory.com/300](https://devkingdom.tistory.com/300)
- [https://medium.com/@jang.wangsu/설계-용어-응집도와-결합도-b5e2b7b210ff](https://medium.com/@jang.wangsu/%EC%84%A4%EA%B3%84-%EC%9A%A9%EC%96%B4-%EC%9D%91%EC%A7%91%EB%8F%84%EC%99%80-%EA%B2%B0%ED%95%A9%EB%8F%84-b5e2b7b210ff)
- [https://mangkyu.tistory.com/195](https://mangkyu.tistory.com/195)